package com.srm.spring.app.service;

import java.util.ArrayList;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;
import com.srm.spring.app.dao.CustomerAddressDAO;
import com.srm.spring.app.dao.CustomerCredientialsDAO;
import com.srm.spring.app.dao.CustomerDetailsDAO;
import com.srm.spring.app.dto.CustomerAddressDetailsDTO;
import com.srm.spring.app.dto.CustomerCredientialsDTO;
import com.srm.spring.app.dto.CustomerDetailsDTO;
import com.srm.spring.app.model.CustomerAddressDetails;
import com.srm.spring.app.model.CustomerDetails;

@Component
public class CustomerDetailsService {
	
	@Autowired
	CustomerDetailsDAO customerDetailsDAO;
	
	@Autowired
	CustomerAddressDAO customerAddressDAO;
	
	@Autowired
	CustomerCredientialsDAO customerCredientialsDAO;
	
	
	public CustomerDetailsDTO saveCustomerDetails(CustomerDetailsDTO custDtlsDTO)  throws Exception {
		
		CustomerDetails custDetails = new CustomerDetails();
		custDetails.setCustname(custDtlsDTO.getCustname());
		custDetails.setFathername(custDtlsDTO.getFathername());
		custDetails.setDod(custDtlsDTO.getDod());
		custDetails.setOccupation(custDtlsDTO.getOccupation());
		custDetails.setPanno(custDtlsDTO.getPanno());
		custDetails=customerDetailsDAO.saveCustomerDetails(custDetails);
		custDtlsDTO.setCustid(custDetails.getCustid());
		saveCustAddressDtls(custDtlsDTO.getCustAddressDtlsDTOList(),custDtlsDTO.getCustid());
		return custDtlsDTO;
	}
	
	private List<CustomerAddressDetailsDTO> saveCustAddressDtls(List<CustomerAddressDetailsDTO> custAddList,Integer custId) throws Exception{
		
	
		
		for(CustomerAddressDetailsDTO dto :custAddList){
			CustomerAddressDetails custAddDtls = new CustomerAddressDetails();
			custAddDtls.setAddresstype(custAddDtls.getAddresstype());
			custAddDtls.setAddress(dto.getAddress());
			custAddDtls.setStreet(dto.getStreet());
			custAddDtls.setCity(dto.getCity());
			custAddDtls.setPincode(dto.getPincode());
			custAddDtls=customerAddressDAO.saveCustomerAddressDetails(custAddDtls);
			dto.setAddressid(custAddDtls.getAddressid());
		}
		return custAddList;
	}
	
    private CustomerCredientialsDTO saveCustCredientialsDtls(CustomerCredientialsDTO custCredientialsDTO){
		
    	
    	
		
		return custCredientialsDTO;
	}
	
	
	

}
